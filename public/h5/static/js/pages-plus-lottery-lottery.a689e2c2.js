(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-plus-lottery-lottery"],{"03e6":function(t,e,i){var n=i("d19d");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("5ced79bf",n,!0,{sourceMap:!1,shadowMode:!1})},"0661":function(t,e,i){"use strict";i("a9e3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={name:"load-more",props:{loadingType:{type:Number,default:0},showImage:{type:Boolean,default:!0},color:{type:String,default:"#777777"},contentText:{type:Object,default:function(){return{contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"没有更多数据了"}}}},data:function(){return{}}};e.default=n},"06c5":function(t,e,i){"use strict";i("a630"),i("fb6a"),i("d3b7"),i("25f0"),i("3ca3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;var n=a(i("6b75"));function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(t){if("string"===typeof t)return(0,n.default)(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?(0,n.default)(t,e):void 0}}},"1d71":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return n}));var n={almostLottery:i("f8d7").default},a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"bg-lottery",style:"background-image: url("+t.bg_image+");"},[i("v-uni-view",{staticClass:"rule-title"},[i("v-uni-view",{staticClass:"rule-title-t"},[t._v("积分:"),i("v-uni-text",{staticClass:"yellow"},[t._v(t._s(t.user_points))])],1),i("v-uni-view",{staticClass:"tc mt20"},[t._v("每次抽奖消耗 "+t._s(t.points)+" 积分,今日剩余"+t._s(t.times)+"次")])],1),i("v-uni-view",{staticClass:"lottery-title"},[t.prizeList.length?i("almost-lottery",{attrs:{prizeList:t.prizeList,prizeIndex:t.prizeIndex,lotteryBg:"/uni_modules/almost-lottery/static/almost-lottery/almost-lottery__bg.png",actionBg:"/uni_modules/almost-lottery/static/almost-lottery/almost-lottery__action.png"},on:{"reset-index":function(e){arguments[0]=e=t.$handleEvent(e),t.prizeIndex=-1},"draw-start":function(e){arguments[0]=e=t.$handleEvent(e),t.handleDrawStart.apply(void 0,arguments)},"draw-end":function(e){arguments[0]=e=t.$handleEvent(e),t.handleDrawEnd.apply(void 0,arguments)},finish:function(e){arguments[0]=e=t.$handleEvent(e),t.handleDrawFinish.apply(void 0,arguments)}}}):t._e()],1),i("v-uni-view",{staticClass:"special-box"},[i("v-uni-view",{staticClass:"special-content",class:"display_1"},[i("v-uni-view",{staticClass:"special-content-list",style:"transform: translate(0,"+t.styleValue+"px);"},t._l(t.listData,(function(e,n){return i("v-uni-view",{key:n,staticClass:"content-item text-ellipsis"},[i("v-uni-text",[t._v(t._s(e.showText))])],1)})),1)],1)],1),i("v-uni-view",{staticClass:"ww100 mb23"},[i("v-uni-button",{staticClass:"btn-red record",attrs:{type:"default"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getRecord()}}},[t._v("中奖记录")])],1),i("v-uni-view",{staticClass:"ruler-box"},[i("v-uni-view",{staticClass:"f30 fb mb23"},[t._v("活动规则")]),i("v-uni-view",{staticClass:"f30",domProps:{innerHTML:t._s(t.content)}})],1),i("popup",{attrs:{show:t.isPopup,type:"middle",backgroundColor:"#ea564c",padding:40,width:638},on:{hidePopup:function(e){arguments[0]=e=t.$handleEvent(e),t.hidePopup.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"pr ww100 tc mb38"},[i("v-uni-view",{staticClass:"pop-tit-line"}),i("v-uni-view",{staticClass:"pop-tit-text"},[t._v("恭喜，中奖啦")])],1),i("v-uni-view",{staticClass:"d-c-c d-c ww100 product-box pr"},[i("v-uni-view",{staticClass:"circular-left"}),i("v-uni-view",{staticClass:"circular-right"}),i("v-uni-view"),i("v-uni-view",{staticClass:"pop_img"},[i("v-uni-image",{attrs:{src:t.result.image,mode:""}})],1),i("v-uni-view",{},[i("v-uni-view",{staticClass:"f26 text-ellipsis fb"},[t._v(t._s(t.result.name))])],1)],1)],1),i("popup",{attrs:{show:t.isRecord,type:"bottom",padding:0,width:750},on:{hidePopup:function(e){arguments[0]=e=t.$handleEvent(e),t.hideRecordPopup.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"p30 record-box"},[i("v-uni-view",{staticClass:"pr ww100 tc mb38"},[i("v-uni-view",{staticClass:"pop-record-line"}),i("v-uni-view",{staticClass:"pop-record-text"},[t._v("我的记录")])],1),i("v-uni-view",[i("v-uni-scroll-view",{staticStyle:{"max-height":"600rpx"},attrs:{"scroll-y":"true","lower-threshold":"50"},on:{scrolltolower:function(e){arguments[0]=e=t.$handleEvent(e),t.scrolltolowerFunc.apply(void 0,arguments)}}},[t._l(t.recordList,(function(e,n){return i("v-uni-view",{key:n,staticClass:"d-b-c border-b-d9",staticStyle:{height:"70rpx"}},[i("v-uni-view",{},[t._v(t._s(e.record_name))]),i("v-uni-view",{staticClass:"d-e-c"},[i("v-uni-view",{staticClass:"gray9"},[t._v(t._s(e.create_time))]),0==e.status?i("v-uni-button",{staticClass:"btn-red record-list-btn",attrs:{type:"default"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.gotoPage("/pages/plus/lottery/receive?record_id="+e.record_id)}}},[t._v("领取")]):i("v-uni-button",{staticClass:"btn-gray record-list-btn",attrs:{type:"default"}},[t._v("已领取")])],1)],1)})),0!=t.recordList.length||t.loading?i("uni-load-more",{attrs:{loadingType:t.loadingType}}):i("v-uni-view",{staticClass:"d-c-c p30"},[i("v-uni-text",{staticClass:"iconfont icon-wushuju"}),i("v-uni-text",{staticClass:"cont"},[t._v("亲，暂无相关记录哦")])],1)],2)],1)],1)],1)],1)},r=[]},"1da1":function(t,e,i){"use strict";function n(t,e,i,n,a,r,o){try{var s=t[r](o),l=s.value}catch(c){return void i(c)}s.done?e(l):Promise.resolve(l).then(n,a)}function a(t){return function(){var e=this,i=arguments;return new Promise((function(a,r){var o=t.apply(e,i);function s(t){n(o,a,r,s,l,"next",t)}function l(t){n(o,a,r,s,l,"throw",t)}s(void 0)}))}}i("d3b7"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},"1e08":function(t,e,i){"use strict";i.r(e);var n=i("4797"),a=i("d8b8");for(var r in a)"default"!==r&&function(t){i.d(e,t,(function(){return a[t]}))}(r);i("3558");var o,s=i("f0c5"),l=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"0aecc60a",null,!1,n["a"],o);e["default"]=l.exports},"243a":function(t,e,i){"use strict";i.r(e);var n=i("8f5a"),a=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,(function(){return n[t]}))}(r);e["default"]=a.a},"282d":function(t,e,i){"use strict";i.r(e);var n=i("1d71"),a=i("243a");for(var r in a)"default"!==r&&function(t){i.d(e,t,(function(){return a[t]}))}(r);i("aed6");var o,s=i("f0c5"),l=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"22fb62fb",null,!1,n["a"],o);e["default"]=l.exports},2909:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=l;var n=s(i("6005")),a=s(i("db90")),r=s(i("06c5")),o=s(i("3427"));function s(t){return t&&t.__esModule?t:{default:t}}function l(t){return(0,n.default)(t)||(0,a.default)(t)||(0,r.default)(t)||(0,o.default)()}},3427:function(t,e,i){"use strict";function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},3558:function(t,e,i){"use strict";var n=i("03e6"),a=i.n(n);a.a},"37c3":function(t,e,i){"use strict";var n;i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return n}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"load-more"},[i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:1===t.loadingType&&t.showImage,expression:"loadingType === 1 && showImage"}],staticClass:"loading-img"},[i("v-uni-view",{staticClass:"load1"},[i("v-uni-view",{style:{background:t.color}}),i("v-uni-view",{style:{background:t.color}}),i("v-uni-view",{style:{background:t.color}}),i("v-uni-view",{style:{background:t.color}})],1),i("v-uni-view",{staticClass:"load2"},[i("v-uni-view",{style:{background:t.color}}),i("v-uni-view",{style:{background:t.color}}),i("v-uni-view",{style:{background:t.color}}),i("v-uni-view",{style:{background:t.color}})],1),i("v-uni-view",{staticClass:"load3"},[i("v-uni-view",{style:{background:t.color}}),i("v-uni-view",{style:{background:t.color}}),i("v-uni-view",{style:{background:t.color}}),i("v-uni-view",{style:{background:t.color}})],1)],1),i("v-uni-text",{staticClass:"loading-text",style:{color:t.color}},[t._v(t._s(0===t.loadingType?t.contentText.contentdown:1===t.loadingType?t.contentText.contentrefresh:t.contentText.contentnomore))])],1)},r=[]},4797:function(t,e,i){"use strict";var n;i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return n}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"uni-mask",style:{top:t.offsetTop+"px"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hide.apply(void 0,arguments)}}}),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],class:["uni-popup","uni-popup-"+t.type],style:"width:"+t.width+"rpx; heigth:"+t.heigth+"rpx;padding:"+t.padding+"rpx;background-color:"+t.backgroundColor+";box-shadow:"+t.boxShadow+";"},[""!=t.msg?i("v-uni-view",{staticClass:"popup-head"},[t._v(t._s(t.msg))]):t._e(),t._t("default")],2)],1)},r=[]},"5bd6":function(t,e,i){"use strict";i("a9e3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={props:{show:{type:Boolean,default:!1},type:{type:String,default:"middle"},width:{type:Number,default:600},heigth:{type:Number,default:800},padding:{type:Number,default:30},backgroundColor:{type:String,default:"#ffffff"},boxShadow:{type:String,default:"0 0 30upx rgba(0, 0, 0, .1)"},msg:{type:String,default:""}},data:function(){var t=0;return t=0,{offsetTop:t}},methods:{hide:function(){this.$emit("hidePopup")}}};e.default=n},6005:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;var n=a(i("6b75"));function a(t){return t&&t.__esModule?t:{default:t}}function r(t){if(Array.isArray(t))return(0,n.default)(t)}},"6b75":function(t,e,i){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"8e08":function(t,e,i){"use strict";i("c975"),i("ace4"),i("d3b7"),i("ac1f"),i("3ca3"),i("466d"),i("5319"),i("1276"),i("5cc6"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("2954"),i("649e"),i("219c"),i("b39a"),i("72f7"),i("ddb0"),i("2b3d"),Object.defineProperty(e,"__esModule",{value:!0}),e.base64ToPath=e.pathToBase64=e.clearCacheFile=e.downloadFile=e.clacTextLen=e.clearStore=e.getStore=e.setStore=void 0;var n=function(t,e){t&&("string"!==typeof e&&(e=JSON.stringify(e)),uni.setStorageSync(t,e))};e.setStore=n;var a=function(t){if(t)return uni.getStorageSync(t)};e.getStore=a;var r=function(t){t?uni.removeStorageSync(t):(console.log("清理本地全部缓存"),uni.clearStorageSync())};e.clearStore=r;var o=function(t){if(!t)return{byteLen:0,realLen:0};t+="";for(var e=0,i=0;i<t.length;i++)t.charCodeAt(i)<0||t.charCodeAt(i)>255?e+=2:e+=1;return{byteLen:e,realLen:e/2}};e.clacTextLen=o;var s=function(t){return new Promise((function(e){uni.downloadFile({url:t,success:function(t){200===t.statusCode?e({ok:!0,data:t.errMsg,tempFilePath:t.tempFilePath}):e({ok:!1,data:t.errMsg,msg:"图片下载失败"})},fail:function(t){e({ok:!1,data:t.errMsg,msg:"图片下载失败"})}})}))};e.downloadFile=s;var l=function(){r()};e.clearCacheFile=l;var c=function(t){if(0===t.indexOf("_www")||0===t.indexOf("_doc")||0===t.indexOf("_documents")||0===t.indexOf("_downloads"))return t;if(0===t.indexOf("/storage/emulated/0/"))return t;if(0===t.indexOf("/storage/sdcard0/"))return t;if(0===t.indexOf("/var/mobile/"))return t;if(0===t.indexOf("file://"))return t;if(0===t.indexOf("/")){var e="iOS"===plus.os.name?t:plus.io.convertLocalFileSystemURL(t);if(e!==t)return e;t=t.substring(1)}return"_www/"+t},u=function(t){return new Promise((function(e,i){if("object"===typeof window&&"document"in window){if("function"===typeof FileReader){var n=new XMLHttpRequest;return n.open("GET",t,!0),n.responseType="blob",n.onload=function(){if(200===this.status){var t=new FileReader;t.onload=function(t){e(t.target.result)},t.onerror=i,t.readAsDataURL(this.response)}},n.onerror=i,void n.send()}var a=document.createElement("canvas"),r=a.getContext("2d"),o=new Image;return o.onload=function(){a.width=o.width,a.height=o.height,r.drawImage(o,0,0),e(a.toDataURL()),a.height=a.width=0},o.onerror=i,void(o.src=t)}if("object"!==typeof plus)"object"===typeof wx&&wx.canIUse("getFileSystemManager")?wx.getFileSystemManager().readFile({filePath:t,encoding:"base64",success:function(t){e("data:image/png;base64,"+t.data)},fail:function(t){i(t)}}):i(new Error("not support"));else{var s=c(t);plus.io.resolveLocalFileSystemURL(s,(function(t){t.file((function(t){var n=new plus.io.FileReader;n.onload=function(t){e(t.target.result)},n.onerror=function(t){console.log(t),i(t)},n.readAsDataURL(t)}),(function(t){i(t)}))}),(function(t){i(t)}))}}))};e.pathToBase64=u;var d=function(t){return new Promise((function(e,i){if("object"===typeof window&&"document"in window){t=t.split(",");var n=t[0].match(/:(.*?);/)[1],a=atob(t[1]),r=a.length,o=new Uint8Array(r);while(r--)o[r]=a.charCodeAt(r);return e((window.URL||window.webkitURL).createObjectURL(new Blob([o],{type:n})))}var s=t.match(/data\:\S+\/(\S+);/);s?s=s[1]:i(new Error("base64 error"));var l=Date.now()+"."+s;if("object"!==typeof plus)if("object"===typeof wx&&wx.canIUse("getFileSystemManager")){var c=wx.env.USER_DATA_PATH+"/"+l;wx.getFileSystemManager().writeFile({filePath:c,data:t.replace(/^data:\S+\/\S+;base64,/,""),encoding:"base64",success:function(){e(c)},fail:function(t){i(t)}})}else i(new Error("not support"));else{var u=new plus.nativeObj.Bitmap("bitmap"+Date.now());u.loadBase64Data(t,(function(){var t="_doc/uniapp_temp/"+l;u.save(t,{},(function(){u.clear(),e(t)}),(function(t){u.clear(),i(t)}))}),(function(t){u.clear(),i(t)}))}}))};e.base64ToPath=d},"8edb":function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,".load-more[data-v-3fb1f804]{display:flex;flex-direction:row;height:%?80?%;align-items:center;justify-content:center}.loading-img[data-v-3fb1f804]{height:24px;width:24px;margin-right:10px}.loading-text[data-v-3fb1f804]{font-size:%?28?%;color:#777}.loading-img>uni-view[data-v-3fb1f804]{position:absolute}.load1[data-v-3fb1f804],\n.load2[data-v-3fb1f804],\n.load3[data-v-3fb1f804]{height:24px;width:24px}.load2[data-v-3fb1f804]{-webkit-transform:rotate(30deg);transform:rotate(30deg)}.load3[data-v-3fb1f804]{-webkit-transform:rotate(60deg);transform:rotate(60deg)}.loading-img>uni-view uni-view[data-v-3fb1f804]{width:6px;height:2px;border-top-left-radius:1px;border-bottom-left-radius:1px;background:#777;position:absolute;opacity:.2;-webkit-transform-origin:50%;transform-origin:50%;-webkit-animation:load-data-v-3fb1f804 1.56s ease infinite}.loading-img>uni-view uni-view[data-v-3fb1f804]:nth-child(1){-webkit-transform:rotate(90deg);transform:rotate(90deg);top:2px;left:9px}.loading-img>uni-view uni-view[data-v-3fb1f804]:nth-child(2){-webkit-transform:rotate(180deg);top:11px;right:0}.loading-img>uni-view uni-view[data-v-3fb1f804]:nth-child(3){-webkit-transform:rotate(270deg);transform:rotate(270deg);bottom:2px;left:9px}.loading-img>uni-view uni-view[data-v-3fb1f804]:nth-child(4){top:11px;left:0}.load1 uni-view[data-v-3fb1f804]:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.load2 uni-view[data-v-3fb1f804]:nth-child(1){-webkit-animation-delay:.13s;animation-delay:.13s}.load3 uni-view[data-v-3fb1f804]:nth-child(1){-webkit-animation-delay:.26s;animation-delay:.26s}.load1 uni-view[data-v-3fb1f804]:nth-child(2){-webkit-animation-delay:.39s;animation-delay:.39s}.load2 uni-view[data-v-3fb1f804]:nth-child(2){-webkit-animation-delay:.52s;animation-delay:.52s}.load3 uni-view[data-v-3fb1f804]:nth-child(2){-webkit-animation-delay:.65s;animation-delay:.65s}.load1 uni-view[data-v-3fb1f804]:nth-child(3){-webkit-animation-delay:.78s;animation-delay:.78s}.load2 uni-view[data-v-3fb1f804]:nth-child(3){-webkit-animation-delay:.91s;animation-delay:.91s}.load3 uni-view[data-v-3fb1f804]:nth-child(3){-webkit-animation-delay:1.04s;animation-delay:1.04s}.load1 uni-view[data-v-3fb1f804]:nth-child(4){-webkit-animation-delay:1.17s;animation-delay:1.17s}.load2 uni-view[data-v-3fb1f804]:nth-child(4){-webkit-animation-delay:1.3s;animation-delay:1.3s}.load3 uni-view[data-v-3fb1f804]:nth-child(4){-webkit-animation-delay:1.43s;animation-delay:1.43s}@-webkit-keyframes load-data-v-3fb1f804{0%{opacity:1}100%{opacity:.2}}",""]),t.exports=e},"8f5a":function(t,e,i){"use strict";var n=i("4ea4");i("99af"),i("4160"),i("d3b7"),i("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("2909"));i("96cf");var r=n(i("1da1")),o=n(i("1e08")),s=n(i("f8d7")),l=n(i("f03f")),c={components:{AlmostLottery:s.default,popup:o.default,uniLoadMore:l.default},data:function(){return{loading:!0,finish:!1,times:0,points:"",user_points:"",bg_image:"",content:"",prizeList:[],onStock:!0,prizeIndex:-1,result:{},listData:[],styleValue:"",index_num:0,lineHeight:0,maxSize:0,timer:null,isPopup:!1,isRecord:!1,recordList:[],list_rows:10,last_page:0,page:1,no_more:!1}},computed:{loadingType:function(){return this.loading?1:0!=this.recordList.length&&this.no_more?2:0}},onShow:function(){this.isRecord=!1,this.restoreData(),this.handleInitCanvas()},methods:{init:function(){var t=this;this.listData.length>1&&uni.getSystemInfo({success:function(e){t.lineHeight=e.windowWidth/750*60,t.maxSize=t.listData.length,t.timer=setInterval((function(){t.animation()}),3e3)}})},animation:function(){var t=this;t.index_num++,t.index_num>=t.maxSize&&(t.index_num=0),this.styleValue=-t.lineHeight*t.index_num},getPrizeList:function(){var t=this;return(0,r.default)(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return uni.showLoading({title:"奖品准备中..."}),t.loading=!0,e.next=4,t.requestApiGetPrizeList();case 4:i=e.sent,i.ok?(n=i.data,n.length&&(t.prizeList=n)):(uni.hideLoading(),uni.showToast({title:"获取奖品失败"}));case 6:case"end":return e.stop()}}),e)})))()},requestApiGetPrizeList:function(){var t=this;return new Promise((function(e,i){t._post("plus.lottery.Lottery/getLottery",{},(function(i){t.loading=!1,t.bg_image=i.data.data.file_path,t.content=i.data.data.content,t.prizeList=i.data.data.prize,t.listData=i.data.recordList,t.listData.forEach((function(t,e){var i=Math.floor(30*Math.random())+1;t.showText=i+"分钟前"+t.user.nickName+"抽中了"+t.record_name})),t.times=i.data.nums,t.points=i.data.data.points,t.user_points=i.data.data.user_points,t.init(),e({ok:!0,data:t.prizeList})}))}))},handleInitCanvas:function(){this.prizeList=[],this.getPrizeList()},handleDrawStart:function(){console.log("start");var t=this;!t.loading&&t.finish&&(t.times<=0?t.showError("次数不足"):(t.loading=!0,t._post("plus.lottery.Lottery/draw",{},(function(e){t.times--,t.loading=!1,t.result=e.data.result;for(var i=(0,a.default)(t.prizeList),n=e.data.result.prize_id,r=0;r<i.length;r++){var o=i[r];if(o.prize_id===n){t.prizeIndex=r;break}}console.log("本次抽中奖品 =>",t.prizeList[t.prizeIndex].name)}),(function(e){t.loading=!1}))))},hidePopup:function(){this.isPopup=!1},hideRecordPopup:function(){this.isRecord=!1},handleDrawEnd:function(){this.isPopup=!0,this.handleInitCanvas()},handleDrawFinish:function(t){this.finish=!0},restoreData:function(){this.recordList=[],this.page=1,this.no_more=!1,this.last_page=1},getList:function(){var t=this;t.loading=!0,t._post("plus.lottery.Lottery/record",{list_rows:t.list_rows,page:t.page||1},(function(e){t.loading=!1,t.recordList=t.recordList.concat(e.data.list.data),t.last_page=e.data.list.last_page,e.data.list.last_page<=1&&(t.no_more=!0)}))},getRecord:function(){this.restoreData(),this.getList(),this.isRecord=!0},scrolltolowerFunc:function(){var t=this;if(t.page++,t.loading=!0,t.page>t.last_page)return t.loading=!1,void(t.no_more=!0);t.getList()}}};e.default=c},"96cf":function(t,e){!function(e){"use strict";var i,n=Object.prototype,a=n.hasOwnProperty,r="function"===typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag",c="object"===typeof t,u=e.regeneratorRuntime;if(u)c&&(t.exports=u);else{u=e.regeneratorRuntime=c?t.exports:{},u.wrap=w;var d="suspendedStart",f="suspendedYield",h="executing",p="completed",g={},v={};v[o]=function(){return this};var m=Object.getPrototypeOf,b=m&&m(m(M([])));b&&b!==n&&a.call(b,o)&&(v=b);var y=L.prototype=_.prototype=Object.create(v);k.prototype=y.constructor=L,L.constructor=k,L[l]=k.displayName="GeneratorFunction",u.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===k||"GeneratorFunction"===(e.displayName||e.name))},u.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,L):(t.__proto__=L,l in t||(t[l]="GeneratorFunction")),t.prototype=Object.create(y),t},u.awrap=function(t){return{__await:t}},S(C.prototype),C.prototype[s]=function(){return this},u.AsyncIterator=C,u.async=function(t,e,i,n){var a=new C(w(t,e,i,n));return u.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(y),y[l]="Generator",y[o]=function(){return this},y.toString=function(){return"[object Generator]"},u.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){while(e.length){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},u.values=M,F.prototype={constructor:F,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=i)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,a){return s.type="throw",s.arg=t,e.next=n,a&&(e.method="next",e.arg=i),!!a}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var l=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),P(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var a=n.arg;P(i)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:M(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=i),g}}}function w(t,e,i,n){var a=e&&e.prototype instanceof _?e:_,r=Object.create(a.prototype),o=new F(n||[]);return r._invoke=z(t,i,o),r}function x(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(n){return{type:"throw",arg:n}}}function _(){}function k(){}function L(){}function S(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function C(t){function e(i,n,r,o){var s=x(t[i],t,n);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"===typeof c&&a.call(c,"__await")?Promise.resolve(c.__await).then((function(t){e("next",t,r,o)}),(function(t){e("throw",t,r,o)})):Promise.resolve(c).then((function(t){l.value=t,r(l)}),(function(t){return e("throw",t,r,o)}))}o(s.arg)}var i;function n(t,n){function a(){return new Promise((function(i,a){e(t,n,i,a)}))}return i=i?i.then(a,a):a()}this._invoke=n}function z(t,e,i){var n=d;return function(a,r){if(n===h)throw new Error("Generator is already running");if(n===p){if("throw"===a)throw r;return A()}i.method=a,i.arg=r;while(1){var o=i.delegate;if(o){var s=T(o,i);if(s){if(s===g)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===d)throw n=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=h;var l=x(t,e,i);if("normal"===l.type){if(n=i.done?p:f,l.arg===g)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=p,i.method="throw",i.arg=l.arg)}}}function T(t,e){var n=t.iterator[e.method];if(n===i){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=i,T(t,e),"throw"===e.method))return g;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var a=x(n,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,g;var r=a.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=i),e.delegate=null,g):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function F(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function M(t){if(t){var e=t[o];if(e)return e.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){while(++n<t.length)if(a.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=i,e.done=!0,e};return r.next=r}}return{next:A}}function A(){return{value:i,done:!0}}}(function(){return this||"object"===typeof self&&self}()||Function("return this")())},"9c51":function(t,e,i){"use strict";var n;i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return n}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"almost-lottery"},[t.lotteryImg?i("v-uni-view",{staticClass:"almost-lottery__wrap",style:{width:t.outerWidth+t.higtCanvasMargin+"px",height:t.outerWidth+t.higtCanvasMargin+"px"}},[i("v-uni-image",{staticClass:"almost-lottery__bg",style:{width:t.outerWidth+t.higtCanvasMargin+"px",height:t.outerWidth+t.higtCanvasMargin+"px"},attrs:{mode:"widthFix",src:t.lotteryBg}}),i("v-uni-image",{staticClass:"almost-lottery__canvas-img",style:{width:t.canvasWidth+"px",height:t.canvasWidth+"px",transform:"rotate("+(t.canvasAngle+t.targetAngle)+"deg)",transitionDuration:t.transitionDuration+"s"},attrs:{mode:"widthFix",src:t.lotteryImg}}),i("v-uni-image",{staticClass:"almost-lottery__action almost-lottery__action-bg",style:{width:t.actionWidth+"px",height:t.actionHeight+"px",transform:"rotate("+(t.actionAngle+t.targetActionAngle)+"deg)",transitionDuration:t.transitionDuration+"s"},attrs:{mode:"widthFix",src:t.actionBg},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleActionStart.apply(void 0,arguments)}}})],1):i("v-uni-text",{staticClass:"almost-lottery__tip"},[t._v(t._s(t.almostLotteryTip))]),i("v-uni-text",{staticClass:"almost-lottery__measureText",style:{fontSize:t.higtFontSize+"px"}},[t._v(t._s(t.measureText))]),i("v-uni-canvas",{class:t.className,style:{width:t.higtCanvasSize+"px",height:t.higtCanvasSize+"px"},attrs:{"canvas-id":t.canvasId,width:t.higtCanvasSize,height:t.higtCanvasSize}})],1)},r=[]},a144:function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.almost-lottery[data-v-0e88030e]{display:flex;justify-content:center;align-items:center;margin:0 auto}.almost-lottery__wrap[data-v-0e88030e]{position:relative;display:flex;justify-content:center;align-items:center}.almost-lottery__action[data-v-0e88030e],\r\n.almost-lottery__bg[data-v-0e88030e],\r\n.almost-lottery__canvas[data-v-0e88030e]{position:absolute}.almost-lottery__canvas[data-v-0e88030e]{left:-9999px;opacity:0;display:flex;justify-content:center;align-items:center}.almost-lottery__canvas-img[data-v-0e88030e],\r\n.almost-lottery__action-bg[data-v-0e88030e]{display:block;transition:-webkit-transform cubic-bezier(.34,.12,.05,.95);transition:transform cubic-bezier(.34,.12,.05,.95);transition:transform cubic-bezier(.34,.12,.05,.95),-webkit-transform cubic-bezier(.34,.12,.05,.95)}.almost-lottery__tip[data-v-0e88030e]{color:#fff;font-size:%?24?%;text-align:center}.almost-lottery__measureText[data-v-0e88030e]{position:absolute;left:0;top:0;white-space:nowrap;font-size:12px;opacity:0}',""]),t.exports=e},a1ad:function(t,e,i){"use strict";var n=i("edb2"),a=i.n(n);a.a},aa99:function(t,e,i){"use strict";var n=i("af25"),a=i.n(n);a.a},aed6:function(t,e,i){"use strict";var n=i("b3ab"),a=i.n(n);a.a},af25:function(t,e,i){var n=i("8edb");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("b28e2978",n,!0,{sourceMap:!1,shadowMode:!1})},b3ab:function(t,e,i){var n=i("e56d");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("14a206bd",n,!0,{sourceMap:!1,shadowMode:!1})},c036:function(t,e,i){"use strict";var n=i("4ea4");i("cb29"),i("c975"),i("fb6a"),i("a9e3"),i("d3b7"),i("ac1f"),i("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("96cf");var a=n(i("1da1")),r=i("8e08"),o=uni.getSystemInfoSync(),s={name:"AlmostLottery",props:{canvasId:{type:String,default:"almostLotteryCanvas"},canvasWidth:{type:Number,default:280},canvasHeight:{type:Number,default:280},outerWidth:{type:Number,default:320},outerHeight:{type:Number,default:320},canvasMargin:{type:Number,default:0},actionWidth:{type:Number,default:120},actionHeight:{type:Number,default:120},prizeList:{type:Array,required:!0,validator:function(t){return t.length>1}},prizeIndex:{type:Number,required:!0},colors:{type:Array,default:function(){return["#FFFFFF","#FFE9AA"]}},lotteryBg:{type:String,default:"/uni_modules/almost-lottery/static/almost-lottery/almost-lottery__bg2x.png"},actionBg:{type:String,default:"/uni_modules/almost-lottery/static/almost-lottery/almost-lottery__action2x.png"},prizeNameDrawed:{type:Boolean,default:!0},stroked:{type:Boolean,default:!1},strokeColor:{type:String,default:"#FFE9AA"},rotateType:{type:String,default:"roulette"},duration:{type:Number,default:8},ringCount:{type:Number,default:8},pointerPosition:{type:String,default:"edge",validator:function(t){return"edge"===t||"middle"===t}},strDirection:{type:String,default:"horizontal"},strFontColor:{type:String,default:"#C30B29"},strFontSize:{type:Number,default:12},strMarginOutside:{type:Number,default:0},imgMarginStr:{type:Number,default:25},strLineHeight:{type:Number,default:1.2},strKey:{type:String,default:"name"},strMaxLen:{type:Number,default:12},strLineLen:{type:Number,default:6},imgWidth:{type:Number,default:30},imgHeight:{type:Number,default:30},successMsg:{type:String,default:"奖品准备就绪，快来参与抽奖吧"},failMsg:{type:String,default:"奖品仍在准备中，请稍后再来..."},canvasCached:{type:Boolean,default:!1}},data:function(){return{className:"almost-lottery__canvas",lotteryImg:"",targetAngle:0,targetActionAngle:0,transitionDuration:0,isRotate:!1,stayIndex:0,targetIndex:0,isCacheImg:!1,oldLotteryImg:"",almostLotteryTip:"奖品准备中...",measureText:""}},computed:{higtCanvasSize:function(){return this.canvasWidth*o.pixelRatio},higtFontSize:function(){return this.strFontSize*o.pixelRatio},higtHeightMultiple:function(){return this.strFontSize*this.strLineHeight*o.pixelRatio},higtCanvasMargin:function(){return this.canvasMargin*o.pixelRatio},canvasAngle:function(){var t=0,e=this.prizeList.length,i=360/e,n=90/i;return t="edge"===this.pointerPosition||"pointer"===this.rotateType?-i*n:-(i*n+i/2),t},actionAngle:function(){return 0},outsideRadius:function(){return this.higtCanvasSize/2},insideRadius:function(){return 20*o.pixelRatio},textRadius:function(){return this.strMarginOutside*o.pixelRatio||this.higtFontSize/2},textDistance:function(){var t=Math.round(this.outsideRadius-this.insideRadius/2);return t-this.textRadius}},watch:{prizeIndex:function(t,e){t>-1?(this.targetIndex=t,this.onRotateStart()):console.info("旋转结束，prizeIndex 已重置")}},methods:{onRotateStart:function(){var t=this;if(!this.isRotate){this.isRotate=!0;var e=this.prizeList.length,i=360/e,n=0;"pointer"===this.rotateType?(n=0===this.targetActionAngle?(this.targetIndex-this.stayIndex)*i+i/2-this.actionAngle:(this.targetIndex-this.stayIndex)*i,this.stayIndex=this.targetIndex,this.targetActionAngle+=n+360*this.ringCount,console.log("targetActionAngle",this.targetActionAngle)):(n=0===this.targetAngle?270-(this.targetIndex-this.stayIndex)*i-i/2-this.canvasAngle:-(this.targetIndex-this.stayIndex)*i,this.stayIndex=this.targetIndex,this.targetAngle+=n+360*this.ringCount);var a=1e3*this.transitionDuration+100,r=setTimeout((function(){clearTimeout(r),r=null,t.isRotate=!1,t.$emit("draw-end")}),a),o=setTimeout((function(){clearTimeout(o),o=null,t.$emit("reset-index")}),a+50)}},handleActionStart:function(){this.lotteryImg&&(this.isRotate||this.$emit("draw-start"))},onCreateCanvas:function(){var t=this;return(0,a.default)(regeneratorRuntime.mark((function e(){var i,n,a,s,l,c,u,d,f,h,p,g,v,m,b,y,w,x,_,k,L,S,C,z,T,I,P,F,M,A,R,j,E,O,N,D,$,H,B,W,U,G;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=t.canvasId,n=uni.createCanvasContext(i,t),a=t.higtCanvasSize,s=t.higtCanvasSize,l=t.prizeList.length,c=2*Math.PI/l,n.setFontSize(t.higtFontSize),u=0;case 8:if(!(u<l)){e.next=126;break}if(d=t.prizeList[u],f=u*c,n.save(),n.beginPath(),n.arc(.5*a,.5*s,t.outsideRadius,f,f+c,!1),n.arc(.5*a,.5*s,t.insideRadius,f+c,f,!0),2===t.colors.length?n.setFillStyle(t.colors[u%2]):n.setFillStyle(t.colors[u]),n.fill(),t.stroked&&(n.setStrokeStyle("".concat(t.strokeColor)),n.stroke()),h=.5*a+Math.cos(f+c/2)*t.textDistance,p=.5*s+Math.sin(f+c/2)*t.textDistance,n.translate(h,p),n.setFillStyle(t.strFontColor),g=t.strLimit(d[t.strKey]),n.rotate(f+c/2+Math.PI/2),"horizontal"!==t.strDirection){e.next=72;break}if(!g||!t.prizeNameDrawed){e.next=70;break}if(v=(0,r.clacTextLen)(g).realLen,m=v>t.strLineLen,!m){e.next=56;break}for(b="",y="",w=0,x=0;x<g.length;x++)w+=(0,r.clacTextLen)(g[x]).byteLen,w<=2*t.strLineLen?b+=g[x]:y+=g[x];g=b+","+y,_=g.split(","),k=0;case 36:if(!(k<_.length)){e.next=54;break}if(!(n.measureText&&n.measureText(_[k]).width>0)){e.next=43;break}L=n.measureText(_[k]),S=-(L.width/2).toFixed(2),n.fillText(_[k],S,k*t.higtHeightMultiple),e.next=51;break;case 43:return t.measureText=_[k],e.next=46,t.$nextTick();case 46:return e.next=48,t.getTextWidth();case 48:C=e.sent,z=-(C/2).toFixed(2),n.fillText(_[k],z,k*t.higtHeightMultiple);case 51:k++,e.next=36;break;case 54:e.next=70;break;case 56:if(!(n.measureText&&n.measureText(g).width>0)){e.next=62;break}T=n.measureText(g),I=-(T.width/2).toFixed(2),n.fillText(g,I,0),e.next=70;break;case 62:return t.measureText=g,e.next=65,t.$nextTick();case 65:return e.next=67,t.getTextWidth();case 67:P=e.sent,F=-(P/2).toFixed(2),n.fillText(g,F,0);case 70:e.next=92;break;case 72:M=g.split(""),A=0;case 74:if(!(A<M.length)){e.next=92;break}if(!(n.measureText&&n.measureText(M[A]).width>0)){e.next=81;break}R=n.measureText(M[A]),j=-(R.width/2).toFixed(2),n.fillText(M[A],j,A*t.higtHeightMultiple),e.next=89;break;case 81:return t.measureText=M[A],e.next=84,t.$nextTick();case 84:return e.next=86,t.getTextWidth();case 86:E=e.sent,O=-(E/2).toFixed(2),n.fillText(M[A],O,A*t.higtHeightMultiple);case 89:A++,e.next=74;break;case 92:if(!d.image||"vertical"===t.strDirection){e.next=122;break}if(N=/^(https|http)/g,!N.test(d.image)){e.next=112;break}return D="",D="需要处理好跨域问题，",console.warn("###当前数据列表中的奖品图片为网络图片，".concat(D,"开始尝试下载图片...###")),e.next=100,(0,r.downloadFile)(d.image);case 100:if($=e.sent,console.log("处理远程图片",$),!$.ok){e.next=109;break}return H=$.tempFilePath,e.next=106,(0,r.pathToBase64)(H);case 106:d.image=e.sent,e.next=110;break;case 109:t.handlePrizeImgSuc({ok:!1,data:$.data,msg:$.msg});case 110:e.next=117;break;case 112:if(console.log("处理非远程图片",d.image),-1!==d.image.indexOf(";base64,")){e.next=117;break}return e.next=116,(0,r.pathToBase64)(d.image);case 116:d.image=e.sent;case 117:B=-t.imgWidth*o.pixelRatio/2,W=t.imgMarginStr*o.pixelRatio,U=t.imgWidth*o.pixelRatio,G=t.imgHeight*o.pixelRatio,n.drawImage(d.image,B,W,U,G);case 122:n.restore();case 123:u++,e.next=8;break;case 126:n.draw(!0,(function(){var e=setTimeout((function(){clearTimeout(e),e=null,uni.canvasToTempFilePath({canvasId:t.canvasId,success:function(e){t.handlePrizeImg({ok:!0,data:e.tempFilePath,msg:"画布导出生成图片成功"})},fail:function(e){t.handlePrizeImg({ok:!1,data:e,msg:"画布导出生成图片失败"})}},t)}),500)}));case 127:case"end":return e.stop()}}),e)})))()},handlePrizeImg:function(t){if(t.ok){var e=t.data;if(!this.canvasCached)return this.lotteryImg=e,void this.handlePrizeImgSuc(t);(0,r.setStore)("".concat(this.canvasId,"LotteryImg"),e),this.lotteryImg=e,this.handlePrizeImgSuc(t);var i=this.isCacheImg?"缓存":"导出";console.info("当前为 H5 端，使用".concat(i,"中的 base64 图"))}else console.error("处理导出的图片失败",t),uni.hideLoading(),console.error("###当前为 H5 端，下载网络图片需要后端配置允许跨域###")},handlePrizeImgSuc:function(t){uni.hideLoading(),this.$emit("finish",{ok:t.ok,data:t.data,msg:t.ok?this.successMsg:this.failMsg}),this.almostLotteryTip=t.ok?this.successMsg:this.failMsg},getTextWidth:function(){console.warn("正在采用兼容方式获取文本的 size 信息，虽然没有任何问题，如果可以，请将此 systemInfo 及 hbx 版本号 反馈给作者",o);var t=uni.createSelectorQuery().in(this),e=t.select(".almost-lottery__measureText");return new Promise((function(t,i){e.fields({size:!0},(function(e){t(e.width)})).exec()}))},strLimit:function(t){var e=this.strMaxLen;return t&&e&&(0,r.clacTextLen)(t).realLen>e?t.slice(0,e-1)+"..":t},checkCacheImg:function(){console.log("检查本地缓存中是否存在转盘图"),this.oldLotteryImg=(0,r.getStore)("".concat(this.canvasId,"LotteryImg"));var t=(0,r.getStore)("".concat(this.canvasId,"PrizeList")),e=JSON.stringify(this.prizeList);if(this.oldLotteryImg&&t===e)return console.log("经查，本地缓存中存在转盘图 => ".concat(this.oldLotteryImg)),this.isCacheImg=!0,console.log("需要继续判断这张缓存图是否可用"),void this.handlePrizeImg({ok:!0,data:this.oldLotteryImg,msg:"画布导出生成图片成功"});console.log("经查，本地缓存中不存在转盘图"),this.initCanvasDraw()},initCanvasDraw:function(){console.log("开始初始化转盘绘制"),this.isCacheImg=!1,this.lotteryImg="",(0,r.clearStore)("".concat(this.canvasId,"LotteryImg")),(0,r.setStore)("".concat(this.canvasId,"PrizeList"),this.prizeList),this.onCreateCanvas()}},mounted:function(){var t=this;this.$nextTick((function(){var e=setTimeout((function(){clearTimeout(e),e=null,t.canvasCached?t.checkCacheImg():t.onCreateCanvas(),t.transitionDuration=t.duration}),50)}))}};e.default=s},cb29:function(t,e,i){var n=i("23e7"),a=i("81d5"),r=i("44d2");n({target:"Array",proto:!0},{fill:a}),r("fill")},d19d:function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,".uni-mask[data-v-0aecc60a]{position:fixed;z-index:998;top:0;right:0;bottom:0;left:0;background-color:rgba(0,0,0,.3)}.uni-popup[data-v-0aecc60a]{position:fixed;z-index:999}.uni-popup-middle[data-v-0aecc60a]{display:flex;flex-direction:column;align-items:flex-start;width:%?600?%;\n\t/* height:800upx; */border-radius:%?10?%;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);justify-content:flex-start;padding:%?30?%;overflow:auto}.popup-head[data-v-0aecc60a]{width:100%;padding-bottom:%?40?%;box-sizing:border-box;font-size:%?30?%;font-weight:700}.uni-popup-top[data-v-0aecc60a]{top:0;left:0;width:100%;height:%?100?%;line-height:%?100?%;text-align:center}.uni-popup-bottom[data-v-0aecc60a]{left:0;bottom:0;width:100%;text-align:center}",""]),t.exports=e},d8b8:function(t,e,i){"use strict";i.r(e);var n=i("5bd6"),a=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,(function(){return n[t]}))}(r);e["default"]=a.a},db90:function(t,e,i){"use strict";function n(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}i("a4d3"),i("e01a"),i("d28b"),i("a630"),i("d3b7"),i("3ca3"),i("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},e56d:function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.bg-lottery[data-v-22fb62fb]{width:%?750?%;min-height:%?1843?%;background-size:%?750?% %?1843?%;background-position:0 0;overflow:hidden}.rule-title[data-v-22fb62fb]{font-size:%?26?%;margin:0 auto;width:%?640?%;margin-top:%?220?%;color:#fff}.rule-title-t[data-v-22fb62fb]{background-color:#ee1413;border-radius:%?12?%;height:%?80?%;line-height:%?80?%;width:%?400?%;padding:%?25?% %?35?%;box-sizing:border-box;display:flex;justify-content:center;align-items:center;margin:0 auto}.lottery-title[data-v-22fb62fb]{padding-top:%?40?%;position:relative;z-index:1}.lottery-base[data-v-22fb62fb]{position:relative;z-index:0;margin-top:%?-6?%;margin-bottom:%?80?%}.base-image[data-v-22fb62fb]{width:%?424?%;height:%?186?%;margin:0 auto}.btn-image[data-v-22fb62fb]{position:absolute;left:0;right:0;margin:0 auto;bottom:%?-48?%;width:%?262?%;height:%?130?%}.btn-red.record[data-v-22fb62fb]{width:%?300?%;height:%?81?%;background:#e03325;border:0 solid #e03325;border-radius:%?10?%;font-size:%?30?%;font-family:SourceHanSansSC;font-weight:500;color:#fff;margin:0 auto;display:flex;justify-content:center;align-items:center}.ruler-box[data-v-22fb62fb]{box-sizing:border-box;width:%?678?%;margin:0 auto;background:#fff;border-radius:%?12?%;padding:%?20?% %?45?%}.special-box[data-v-22fb62fb]{width:%?678?%;height:%?60?%;background:#f9c68b;display:flex;justify-content:center;align-items:center;border-radius:%?22?%;padding:0 %?64?%;box-sizing:border-box;margin:%?60?% auto}.special-content[data-v-22fb62fb]{width:%?551?%;font-size:%?30?%;font-family:Source Han Sans CN;font-weight:500;color:#e8573c;flex:1;margin:0 auto;overflow:hidden}.special-content-list[data-v-22fb62fb]{transition:-webkit-transform .4s;transition:transform .4s;transition:transform .4s,-webkit-transform .4s}.content-item[data-v-22fb62fb]{height:%?60?%;line-height:%?60?%}.special-content.display_1[data-v-22fb62fb]{height:%?60?%}.pop_img[data-v-22fb62fb]{width:%?130?%;height:%?130?%;margin-bottom:%?20?%}.pop_img uni-image[data-v-22fb62fb]{width:%?130?%;height:%?130?%}.pop-record-line[data-v-22fb62fb]{background-color:#333;width:%?245?%;height:%?1?%;position:absolute;top:0;right:0;bottom:0;left:0;margin:auto;z-index:-1}.pop-record-text[data-v-22fb62fb]{color:#333;font-size:%?28?%;background-color:#fff;display:inline;padding:0 %?12?%}.pop-tit-line[data-v-22fb62fb]{background-color:#f5ddc1;width:%?472?%;height:%?2?%;position:absolute;top:0;right:0;bottom:0;left:0;margin:auto;z-index:-1}.pop-tit-text[data-v-22fb62fb]{color:#f5ddc1;font-size:%?52?%;background-color:#ea564c;display:inline;padding:0 %?16?%}.product-box[data-v-22fb62fb]{border-radius:%?24?%;background-color:#fff;padding:%?45?% 0}.circular-right[data-v-22fb62fb]{width:%?44?%;height:%?44?%;border-radius:50%;background-color:#ea564c;position:absolute;top:0;bottom:0;margin:auto 0;right:%?-22?%}.circular-left[data-v-22fb62fb]{width:%?44?%;height:%?44?%;border-radius:50%;background-color:#ea564c;position:absolute;top:0;bottom:0;margin:auto 0;left:%?-22?%}.record-box[data-v-22fb62fb]{padding-bottom:%?70?%}.record-list-btn[data-v-22fb62fb]{width:%?96?%;height:%?40?%;line-height:%?40?%;font-size:%?22?%;color:#fff;display:flex;justify-content:center;align-items:center;padding:0;margin-left:%?16?%}',""]),t.exports=e},e837:function(t,e,i){"use strict";i.r(e);var n=i("0661"),a=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,(function(){return n[t]}))}(r);e["default"]=a.a},ec5c:function(t,e,i){"use strict";i.r(e);var n=i("c036"),a=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,(function(){return n[t]}))}(r);e["default"]=a.a},edb2:function(t,e,i){var n=i("a144");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("2aa407c2",n,!0,{sourceMap:!1,shadowMode:!1})},f03f:function(t,e,i){"use strict";i.r(e);var n=i("37c3"),a=i("e837");for(var r in a)"default"!==r&&function(t){i.d(e,t,(function(){return a[t]}))}(r);i("aa99");var o,s=i("f0c5"),l=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"3fb1f804",null,!1,n["a"],o);e["default"]=l.exports},f8d7:function(t,e,i){"use strict";i.r(e);var n=i("9c51"),a=i("ec5c");for(var r in a)"default"!==r&&function(t){i.d(e,t,(function(){return a[t]}))}(r);i("a1ad");var o,s=i("f0c5"),l=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"0e88030e",null,!1,n["a"],o);e["default"]=l.exports}}]);